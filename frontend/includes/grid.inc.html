<!--<link type="text/css" rel="stylesheet" href="jsgrid.min.css" />-->
<!--<link type="text/css" rel="stylesheet" href="jsgrid-theme.min.css" />-->
<script type="text/javascript" src="//rawgit.com/tabalinas/jsgrid/master/dist/jsgrid.js"></script>
<script>
    var DateField = function(config) {
        jsGrid.Field.call(this, config);
    };
 
    DateField.prototype = new jsGrid.Field({
        sorter: function(date1, date2) {
            return new Date(date1) - new Date(date2);
        },
 
        itemTemplate: function(value) {
            return new Date(value).toDateString();
        },
 
        insertTemplate: function(value) {
            return this._insertPicker = $("<input>").datepicker({ defaultDate: new Date() });
        },
 
        editTemplate: function(value) {
            return this._editPicker = $("<input>").datepicker().datepicker("setDate", new Date(value));
        },
 
        insertValue: function() {
            return this._insertPicker.datepicker("getDate").toISOString();
        },
 
        editValue: function() {
            return this._editPicker.datepicker("getDate").toISOString();
        }
    });
 
    function initGrid(params){
        params.common = params.common || {};
        
        jsGrid.fields.date = DateField;

        $("#data-grid").jsGrid({
                height: "100%",
                width: "auto",
         
                filtering: true,
                editing: true,
                sorting: true,
                paging: true,
                inserting: true,
            
                autoload: true,
                
                pageSize: 15,
                pageButtonCount: 5,
         
                controller: {
                    loadData: function(aFilter) {
                        //returns a Promise
                        if (aFilter){
                            return callAction(params.entity, 'select', 
                                    $.extend({criteria: aFilter}, params.common));
                        }else {
                            return callAction(params.entity, 'getMany', 
                                    $.extend({}, params.common));
                        }
                    },
                    insertItem: function(item) {
                        //returns a Promise
                        return callAction(params.entity, 'create', 
                                $.extend({item: item}, params.common)
                        );
                    },
                    updateItem: function(item) {
                        //returns a Promise
                        return callAction(params.entity, 'update', 
                                $.extend({item: item}, params.common)
                        );
                    },
                    
                },
         
                fields: params.fields
            });
         
    };
</script>