<h1>The Bookings data Manual Update</h1>

<div class="panel panel-warning">
    <div class="panel-heading">
        <h3 class="panel-title">Setup and use the Booking Sources for regular updates! !</h3>
    </div>
    <div class="panel-body">
        This page exists for special cases only, use Booking Sources for normal data flow.
    </div>
</div>

<div class="panel panel-info">
    <div class="panel-heading">
        <h3 class="panel-title">Header Format !</h3>
    </div>
    <div class="panel-body">
        You should have the data header with the following field names: <strong><?= C.fields ?></strong><br />
        Data columns should correspond header names.
        Data header is the first text row for a CSV, or the top cells row in a range or a sheet
    </div>
</div>

<form id="form-NR" class="form-horizontal">
    <fieldset>
        <legend>Import from a Google Spreadsheet Named Range</legend>
        <div class="form-group">
            <label for= "inputSpreadsheetId-NR" class="col-lg-2 control-label">Spreadsheet ID</label>
            <div class="col-lg-10">
                <input type="text" class="form-control floating-label" 
                       id="inputSpreadsheetId-NR" placeholder="Input your Spreadsheet ID, you can find it in URL" />
            </div>
        </div>
        <div class="form-group">
            <label for= "inputRangeName" class="col-lg-2 control-label">Range Name</label>
            <div class="col-lg-10">
                <input type="text" class="form-control floating-label" 
                       id="inputRangeName" placeholder="Input a Range Name (Menu -> Data -> Named Ranges)" />
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-10 col-lg-offset-2">
                <button class="btn btn-default btn-raised">Clear</button>
                <button class="submit btn btn-primary btn-raised">Submit</button>
            </div>
        </div>
    </fieldset>
</form>

<form id="form-Sheet" class="form-horizontal">
    <fieldset>
        <legend>Import from a Google Sheet (data occupy all sheet)</legend>
        <div class="form-group">
            <label for= "inputSpreadsheetId-Sheet" class="col-lg-2 control-label">Spreadsheet ID</label>
            <div class="col-lg-10">
                <input type="text" class="form-control floating-label" 
                       id="inputSpreadsheetId-Sheet" placeholder="Input your Spreadsheet ID, you can find it in URL" />
            </div>
        </div>
        <div class="form-group">
            <label for= "inputSheetName" class="col-lg-2 control-label">Sheet Name</label>
            <div class="col-lg-10">
                <input type="text" class="form-control floating-label" 
                       id="inputSheetName" placeholder="Input Sheet Name" />
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-10 col-lg-offset-2">
                <button class="btn btn-default btn-raised">Clear</button>
                <button class="submit btn btn-primary btn-raised">Submit</button>
            </div>
        </div>
    </fieldset>
</form>    

<form id="form-csv" class="form-horizontal">
    <fieldset>
        <legend>Import from CSV</legend>
        <div class="form-group">
            <label for="CSVArea" class="col-lg-2 control-label">CSV contents</label>
            <div class="col-lg-10">
                <textarea class="form-control" rows="3" id="CSVArea"></textarea>
                <span class="help-block">Copy-Paste CSV file contents here</span>
            </div>
        </div>
        <div class="form-group">
            <label class="col-lg-2 control-label">Choose Fields Delimiter</label>
            <div class="col-lg-10">
                <div class="radio radio-primary">
                    <label>
                        <input type="radio" name="delimiter" id="delimiterTab" value="&#09" checked="">
                        Tab
                    </label>
                </div>
                <div class="radio radio-primary">
                    <label>
                        <input type="radio" name="delimiter" id="delimiterComma" value=",">
                        Comma
                    </label>
                </div>
                <div class="radio radio-primary">
                    <label>
                        <input type="radio" name="delimiter" value="custom">
                        Custom <br /><input type="text" class="form-control floating-label" 
                                               id="delimiterCustom" placeholder="Custom delimiter here" />
                    </label>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-10 col-lg-offset-2">
                <button class="btn btn-default btn-raised">Clear</button>
                <button class="submit btn btn-primary btn-raised">Submit</button>
            </div>
        </div>
    </fieldset>
</form>

<script>
    $(function () {
        var f3 = $("#form-csv");
        f3.find(".submit").on('click', function() {
            var actionParams = {type: 'CSV'};
            actionParams.data = $('#CSVArea').val();
            
            var delimiter = f3.find('input[name=radioName]:checked').val();
            if (delimiter !== 'custom'){
                actionParams.delimiter = delimiter;
            }else{
                actionParams.delimiter = $('#delimiterCustom').val();
            }
            
            callAction('bookings', 'append', actionParams)
                    .then(function(result){
                        //TODO - actually don't need anything here
                    })
            
            return false;
        });

        var f2 = $("#form-Sheet");
        f2.find(".submit").on('click', function() {
            var actionParams = {type: 'sheet'};
            actionParams.sheet = $('#inputSheetName').val();
            actionParams.ss = $('#inputSpreadsheetId-Sheet').val();
            
            callAction('bookings', 'appendRows', actionParams)
                    .then(function(result){
                        //TODO - actually don't need anything here
                    })
            
            return false;
        });

        var f1 = $("#form-NR");
        f1.find(".submit").on('click', function() {
            var actionParams = {type: 'range'};
            actionParams.range = $('#inputRangeName').val();
            actionParams.ss = $('#inputSpreadsheetId-NR').val();
            
            callAction('bookings', 'appendRows', actionParams)
                    .then(function(result){
                        //TODO - actually don't need anything here
                    })
            
            return false;
        });
    });
</script>